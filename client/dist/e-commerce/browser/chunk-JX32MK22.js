import{b as q}from"./chunk-6QFINTJJ.js";import{a as F}from"./chunk-W636PHFJ.js";import{Aa as d,Ba as C,Hb as j,Qa as P,Ra as I,S as E,Sa as o,Ta as a,Ua as g,W as b,Wa as L,Ya as _,ab as l,bb as s,cb as k,eb as T,hb as m,ib as f,o as y}from"./chunk-JMPQY6AR.js";import{e as x}from"./chunk-FDERIQAA.js";var W="https://js.stripe.com/v3",O=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,A="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",R=function(){for(var e=document.querySelectorAll('script[src^="'.concat(W,'"]')),t=0;t<e.length;t++){var n=e[t];if(O.test(n.src))return n}return null},M=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(W).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n},B=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"5.5.0",startTime:t})},u=null,v=null,S=null,V=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},X=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},Q=function(e){return u!==null?u:(u=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(A),window.Stripe){t(window.Stripe);return}try{var r=R();if(r&&e)console.warn(A);else if(!r)r=M(e);else if(r&&S!==null&&v!==null){var c;r.removeEventListener("load",S),r.removeEventListener("error",v),(c=r.parentNode)===null||c===void 0||c.removeChild(r),r=M(e)}S=X(t,n),v=V(n),r.addEventListener("load",S),r.addEventListener("error",v)}catch(h){n(h);return}}),u.catch(function(t){return u=null,Promise.reject(t)}))},U=function(e,t,n){if(e===null)return null;var r=e.apply(void 0,t);return B(r,n),r},p,N=!1,D=function(){return p||(p=Q(null).catch(function(e){return p=null,Promise.reject(e)}),p)};Promise.resolve().then(function(){return D()}).catch(function(i){N||console.warn(i)});var G=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];N=!0;var r=Date.now();return D().then(function(c){return U(c,t,r)})};var Z=(i,e)=>e==null||e.product==null?null:e.product._id;function z(i,e){if(i&1&&(o(0,"li",15)(1,"span",18),l(2),a(),o(3,"span",19),l(4),a(),o(5,"span"),l(6,"x"),a(),o(7,"span",19),l(8),m(9,"currency"),a()()),i&2){let t=e.$implicit;d(),_("title",t.product.title),d(),s(t.product.title),d(2),s(t.quantity),d(4),s(f(9,4,t.product.price))}}var w=class i{constructor(e){this.productsService=e}state=E(q).state;stripe=null;elements=null;card=null;ngOnInit(){return x(this,null,function*(){this.stripe=yield G("pk_test_51PJC6AJeIz2JibtC32QxNpQqNVtPQ06sAJOfLd7CvEkux2WEKekyYZmCaT2gHCLGJSiXIxmWCU6iMwXeZstZAeWG00utnMfqhT"),this.elements=this.stripe?.elements()||null,this.card=this.elements?.create("card",{style:{base:{color:"#32325d",fontSize:"16px","::placeholder":{color:"#aab7c4"}}}})||null,this.card?.mount("#card-element")})}handleSubmit(e){return x(this,null,function*(){if(e.preventDefault(),!this.stripe||!this.card)return;let{error:t,paymentMethod:n}=yield this.stripe.createPaymentMethod({type:"card",card:this.card});if(t)console.error("Stripe Error:",t);else try{let r=localStorage.getItem("authToken"),{id:c}=n,h=Number(this.state.price().toFixed(2))*100,J=this.state.products();if(!r)throw new Error("Authentication token not found");yield y(this.productsService.checkout(c,h,J,r))}catch(r){console.log("Request error:",r)}})}static \u0275fac=function(t){return new(t||i)(C(F))};static \u0275cmp=b({type:i,selectors:[["app-checkout"]],standalone:!0,features:[T],decls:28,vars:6,consts:[[1,"font-[sans-serif]","bg-slate-950","p-4","h-screen","pt-32"],[1,"md:max-w-5xl","max-w-xl","mx-auto"],[1,"grid","md:grid-cols-2","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2","max-md:order-1"],[1,"text-3xl","font-extrabold","text-slate-100"],[1,"text-slate-100","text-sm","mt-4"],[1,"mt-8","max-w-lg"],[1,"grid","gap-4"],["type","text","placeholder","Cardholder's Name",1,"px-4","py-3.5","bg-gray-100","text-gray-800","w-full","text-sm","border","rounded-md","focus:border-blue-500","outline-none"],[1,"w-full","flex","flex-col","gap-4",3,"submit"],["id","card-element",1,"p-3","bg-gray-100","rounded"],["type","submit",1,"bg-green-500","text-white","py-3.5","rounded-md","hover:bg-green-600"],[1,"bg-slate-100","p-6","rounded-md"],[1,"text-3xl","font-bold","text-gray-800"],[1,"text-gray-800","mt-8","space-y-3"],[1,"flex","flex-wrap","gap-4","text-lg","overflow-hidden","whitespace-nowrap","text-ellipsis"],[1,"flex","flex-wrap","gap-4","text-lg","font-bold","border-t-2","pt-4"],[1,"ml-auto"],[1,"flex-1","truncate",3,"title"],[1,"ml-auto","font-bold"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),l(5,"Pay products"),a(),o(6,"p",5),l(7,"Complete your transaction swiftly and securely with our easy-to-use payment process."),a(),o(8,"form",6)(9,"div",7)(10,"div"),g(11,"input",8),a(),o(12,"form",9),L("submit",function(c){return n.handleSubmit(c)}),g(13,"div",10),o(14,"button",11),l(15," Pay "),a()()()()(),o(16,"div",12)(17,"h2",13),l(18),m(19,"currency"),a(),o(20,"ul",14),P(21,z,10,6,"li",15,Z),o(23,"li",16),l(24,"Total "),o(25,"span",17),l(26),m(27,"currency"),a()()()()()()()),t&2&&(d(18),s(f(19,2,n.state.price())),d(3),I(n.state.products()),d(5),k(" ",f(27,4,n.state.price())," "))},dependencies:[j]})};export{w as default};

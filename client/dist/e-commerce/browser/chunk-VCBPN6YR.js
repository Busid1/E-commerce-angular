import{a as B}from"./chunk-COZLRPNY.js";import{a as Z}from"./chunk-BORVIYNG.js";import{e as Y}from"./chunk-TDMIGJZM.js";import{a as W}from"./chunk-2A3FELLY.js";import{a as D}from"./chunk-R2CKWY32.js";import{Aa as p,Ba as P,Ib as R,Ka as F,Na as h,Oa as T,S as b,Sa as r,Ta as o,Ua as u,Va as L,W as g,Wa as l,Xa as E,Ya as s,ab as n,cb as x,da as C,db as H,ea as k,eb as y,fa as _,ga as A,gb as V,hb as O,ib as z,o as f,pa as N,qa as q,vb as G,xa as S}from"./chunk-EW7DCEDO.js";import{d as j,e as m}from"./chunk-FDERIQAA.js";var v=j(W());var w=class a{constructor(i){this.productsService=i}productState=b(U);productDetailState=b(B).state;closeUpdateModal(){this.productState.showUpdateModal=!1,document.body.classList.remove("overflow-hidden")}super(){G(()=>{let i=this.productState._id;i&&this.productDetailState.getById(i)})}formData={title:this.productState.product().title,price:this.productState.product().price,category:this.productState.product().category,image:this.productState.product().image,description:this.productState.product().description};handleOnChange(i,t){let e=t.target.value;i==="price"&&e.length>4&&(e=e.slice(0,3),t.target.value=e),this.formData[i]=e}handleFileChange(i){let t=i.target.files?.[0];t&&(this.formData.image=t),console.log(this.formData.image)}deleteProduct(){v.default.fire({title:"Are you sure you want to delete this product?",showDenyButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(i=>m(this,null,function*(){i.isConfirmed&&(v.default.fire("Removed product","","success"),yield f(this.productsService.deleteProduct(this.productState._id)),window.location.reload())}))}submitUpdateForm(i){return m(this,null,function*(){i.preventDefault();let t=new FormData;t.append("title",this.formData.title),t.append("price",this.formData.price.toString()),t.append("description",this.formData.description),t.append("category",this.formData.category),this.formData.image&&t.append("image",this.formData.image),v.default.fire({title:"Are you sure you want to update this product?",showDenyButton:!0,confirmButtonText:"Yes",denyButtonText:"No",icon:"question"}).then(e=>m(this,null,function*(){if(e.isConfirmed)try{let d=yield f(this.productsService.updateProduct(this.productState._id,t));v.default.fire("Updated product","","success"),setTimeout(()=>{window.location.reload()},2e3),console.log("Updated product:",d)}catch(d){console.error("Error updating the product:",d)}}))})}static \u0275fac=function(t){return new(t||a)(P(D))};static \u0275cmp=g({type:a,selectors:[["app-update-product"]],standalone:!0,features:[H([B]),y],decls:44,vars:7,consts:[["aria-hidden","true","tabindex","-1",1,"fixed","bg-slate-950","bg-opacity-85","h-screen","inset-0","z-50","flex","justify-center","items-center","w-full"],[1,"relative","p-4","w-full","max-w-2xl"],[1,"relative","p-6","bg-slate-900","rounded-lg","shadow"],[1,"flex","justify-between","items-center","pb-4","mb-4","rounded-t","border-b","sm:mb-5","dark:border-gray-600"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"fas","fa-times","hover:bg-red-600","px-3","py-2","rounded","transition",3,"click"],["action","#",3,"submit"],[1,"grid","gap-5","mb-4","sm:grid-cols-2"],["for","name",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","name","name","id","name","placeholder","Type product name","required","",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-primary-600","focus:border-primary-600","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input","value"],["for","price",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","number","name","price","id","price","pattern","[0-9]*","placeholder","$2999","required","",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-primary-600","focus:border-primary-600","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input","value"],["for","category",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["id","category",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-primary-500","focus:border-primary-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input"],["selected","",3,"value"],["value","TV/Monitors"],["value","PC/Laptop"],["value","Gaming/Console"],["value","Phones"],["for","file_input",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"flex","gap-2","h-10"],["id","file_input","name","image","type","file",1,"block","w-full","text-sm","text-gray-900","border","border-gray-300","rounded-lg","cursor-pointer","bg-gray-50","dark:text-gray-400","focus:outline-none","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400",3,"change"],[1,"rounded-md","h-full",3,"src","alt"],[1,"sm:col-span-2"],["for","description",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["id","description","rows","4","placeholder","Write product description here",1,"block","p-2.5","w-full","text-sm","text-gray-900","bg-gray-50","rounded-lg","border","border-gray-300","focus:ring-primary-500","focus:border-primary-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input","value"],["type","submit",1,"text-white","ml-auto","gap-2","bg-orange-600","flex","items-center","hover:bg-orange-700","focus:ring-4","focus:outline-none","focus:ring-orange-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","dark:bg-orange-600","dark:hover:bg-orange-700","dark:focus:ring-orange-800",3,"click"],[1,"fas","fa-pen"]],template:function(t,e){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),n(5," Update Product "),o(),r(6,"button",5),l("click",function(){return e.closeUpdateModal()}),o()(),r(7,"form",6),l("submit",function(c){return e.submitUpdateForm(c)}),r(8,"div",7)(9,"div")(10,"label",8),n(11,"Title"),o(),r(12,"input",9),l("input",function(c){return e.handleOnChange("title",c)}),o()(),r(13,"div")(14,"label",10),n(15,"Price"),o(),r(16,"input",11),l("input",function(c){return e.handleOnChange("price",c)}),o()(),r(17,"div")(18,"label",12),n(19,"Category"),o(),r(20,"select",13),l("input",function(c){return e.handleOnChange("category",c)}),r(21,"option",14),n(22),o(),r(23,"option",15),n(24,"TV/Monitors"),o(),r(25,"option",16),n(26,"PC"),o(),r(27,"option",17),n(28,"Gaming/Console"),o(),r(29,"option",18),n(30,"Phones"),o()()(),r(31,"div")(32,"label",19),n(33,"Image"),o(),r(34,"div",20)(35,"input",21),l("change",function(c){return e.handleFileChange(c)}),o(),u(36,"img",22),o()(),r(37,"div",23)(38,"label",24),n(39,"Description"),o(),r(40,"textarea",25),l("input",function(c){return e.handleOnChange("description",c)}),o()()(),r(41,"button",26),l("click",function(){return e.deleteProduct()}),u(42,"i",27),n(43," Update product "),o()()()()()),t&2&&(p(12),s("value",e.productState.product().title),p(4),s("value",e.productState.product().price),p(5),s("value",e.productState.product().category),p(),x(" ",e.productState.product().category,""),p(14),s("src",e.productState.product().image?e.productState.product().image:"https://www.svgrepo.com/show/508699/landscape-placeholder.svg",S),s("alt",e.productState.product().title),p(4),h("value",e.productState.product().description))}})};var M=j(W());var I=class a{static \u0275fac=function(t){return new(t||a)};static \u0275cmp=g({type:a,selectors:[["app-toast-cart"]],standalone:!0,features:[y],decls:9,vars:0,consts:[[1,"fixed","bottom-4","right-4","z-50"],["id","toast-success","role","alert",1,"flex","items-center","w-full","max-w-xs","p-4","mb-4","text-gray-500","bg-white","rounded-lg","shadow-sm","dark:text-gray-400","dark:bg-gray-800"],[1,"inline-flex","items-center","justify-center","shrink-0","w-8","h-8","text-green-500","bg-green-100","rounded-lg","dark:bg-green-800","dark:text-green-200"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"],[1,"sr-only"],[1,"ms-3","text-sm","font-normal"]],template:function(t,e){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),_(),r(3,"svg",3),u(4,"path",4),o(),A(),r(5,"span",5),n(6,"Check icon"),o()(),r(7,"div",6),n(8,"Product added to cart"),o()()())}})};var K=a=>["/product/",a];function X(a,i){if(a&1){let t=L();r(0,"div",6)(1,"button",8),l("click",function(d){C(t);let c=E();return k(c.edit(d))}),u(2,"i",9),n(3," Edit "),o(),r(4,"button",10),l("click",function(d){C(t);let c=E();return k(c.delete(d))}),u(5,"i",11),n(6," Delete "),o()()}}function ee(a,i){if(a&1){let t=L();r(0,"button",12),l("click",function(d){C(t);let c=E();return k(c.add(d))}),_(),r(1,"svg",13),u(2,"path",14),o(),n(3," Add to cart "),o()}}function te(a,i){a&1&&u(0,"app-toast-cart")}function re(a,i){a&1&&u(0,"app-update-product")}var U=class a{constructor(i){this.productsService=i}product=q.required();isAuthenticated=b(Z);showUpdateModal=!1;addToCart=N();addToCartToast=!1;_id="";add(i){return m(this,null,function*(){if(!this.isAuthenticated.handleIsAuthenticated()){M.default.fire("You are not logged in!","","error");return}let t=localStorage.getItem("authToken");t&&(i.stopPropagation(),i.preventDefault(),this.addToCart.emit(this.product()),this.addToCartToast=!0,setTimeout(()=>{this.addToCartToast=!1},1e3),yield f(this.productsService.addToCart(this.product()._id,t)))})}edit(i){document.body.classList.add("overflow-hidden"),i.stopPropagation(),i.preventDefault(),this.showUpdateModal=!0,this._id=this.product()._id}delete(i){i.preventDefault(),M.default.fire({title:"Are you sure you want to delete this product?",showDenyButton:!0,confirmButtonText:"Yes",denyButtonText:"No",icon:"question"}).then(t=>m(this,null,function*(){t.isConfirmed&&(M.default.fire("Removed product","","success"),yield f(this.productsService.deleteProduct(this.product()._id)),window.location.reload())}))}static \u0275fac=function(t){return new(t||a)(P(D))};static \u0275cmp=g({type:a,selectors:[["app-product-card"]],inputs:{product:[1,"product"]},outputs:{addToCart:"addToCart"},standalone:!0,features:[y],decls:14,vars:15,consts:[[3,"routerLink"],[1,"cursor-pointer","rounded-t-2xl","w-full","h-60","object-cover",3,"src","alt"],[1,"flex","items-center","justify-evenly","p-2"],[1,"text-xl","hover:underline","text-center","p-2","font-medium","max-w-36","truncate","text-white","dark:text-white","overflow-hidden","text-nowrap",3,"routerLink"],[1,"block","text-lg","font-medium","text-white","dark:text-white"],[1,"flex","flex-col","justify-between","items-center","gap-3"],[1,"flex","flex-wrap","gap-4"],[1,"text-white","flex","gap-2","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:ring-blue-300","font-medium","rounded-lg","text-sm","px-4","py-2","focus:outline-none","dark:focus:ring-blue-600"],[1,"inline-flex","items-center","gap-2","text-white","bg-orange-500","hover:bg-orange-600","focus:ring-4","focus:ring-orange-300","font-medium","rounded-md","text-sm","px-4","py-2","dark:bg-orange-600","dark:hover:bg-orange-700","focus:outline-none","dark:focus:ring-orange-800",3,"click"],[1,"fas","fa-pen"],[1,"inline-flex","items-center","gap-2","text-white","bg-red-500","hover:bg-red-600","focus:ring-4","focus:ring-red-300","font-medium","rounded-md","text-sm","px-4","py-2","dark:bg-red-600","dark:hover:bg-red-700","focus:outline-none","dark:focus:ring-red-800",3,"click"],[1,"fas","fa-trash-alt"],[1,"text-white","flex","gap-2","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:ring-blue-300","font-medium","rounded-lg","text-sm","px-4","py-2","focus:outline-none","dark:focus:ring-blue-600",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 4h1.5L9 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm-8.5-3h9.25L19 7H7.312"]],template:function(t,e){t&1&&(r(0,"picture",0),u(1,"img",1),o(),r(2,"div")(3,"div",2)(4,"a",3),n(5),o(),r(6,"span",4),n(7),O(8,"currency"),o()(),r(9,"div",5),F(10,X,7,0,"div",6)(11,ee,4,0,"button",7),o()(),F(12,te,1,0,"app-toast-cart")(13,re,1,0,"app-update-product")),t&2&&(h("routerLink",V(11,K,e.product()._id)),p(),s("alt",e.product().title),h("src",e.product().image?e.product().image:"https://www.svgrepo.com/show/508699/landscape-placeholder.svg",S),p(3),h("routerLink",V(13,K,e.product()._id)),p(),x(" ",e.product().title," "),p(2),x(" ",z(8,9,e.product().price)," "),p(3),T(e.isAuthenticated.isAdmin()?10:11),p(2),T(e.addToCartToast?12:-1),p(),T(e.showUpdateModal?13:-1))},dependencies:[Y,R,w,I]})};export{U as a};

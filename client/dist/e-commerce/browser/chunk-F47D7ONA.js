import{a as F}from"./chunk-NXUSJTZ2.js";import{a as Z}from"./chunk-4L3SM3ZH.js";import{e as R}from"./chunk-JGPHLDAD.js";import{a as W}from"./chunk-2A3FELLY.js";import{a as P}from"./chunk-F4DWTUG2.js";import{Aa as c,Ba as w,Hb as G,Ka as D,Na as g,Oa as U,S as b,Sa as o,Ta as i,Ua as p,Va as I,W as x,Wa as u,Xa as C,Ya as h,ab as n,bb as A,cb as B,da as v,db as q,ea as _,eb as S,fa as L,gb as M,hb as O,ib as H,o as f,pa as j,qa as N,vb as z,xa as k}from"./chunk-JRYPQ5OL.js";import{d as V,e as s}from"./chunk-FDERIQAA.js";var m=V(W());var y=class l{constructor(r){this.productsService=r}productState=b(T);productDetailState=b(F).state;closeUpdateModal(){this.productState.showUpdateModal=!1,document.body.classList.remove("overflow-hidden")}super(){z(()=>{let r=this.productState._id;r&&this.productDetailState.getById(r)})}formData={title:this.productState.product().title,price:this.productState.product().price,category:this.productState.product().category,image:this.productState.product().image,description:this.productState.product().description};handleOnChange(r,t){let e=t.target.value;r==="price"&&e.length>3&&(e=e.slice(0,3),t.target.value=e),this.formData[r]=e}handleFileChange(r){let t=r.target.files?.[0];t&&(this.formData.image=t)}deleteProduct(){m.default.fire({title:"Are you sure you want to delete this product?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No",cancelButtonText:"Cancel"}).then(r=>s(this,null,function*(){r.isConfirmed?(m.default.fire("Removed product","","success"),yield f(this.productsService.deleteProduct(this.productState._id)),window.location.reload()):r.isDenied&&m.default.fire("Product not removed","","info")}))}submitUpdateForm(r){return s(this,null,function*(){r.preventDefault();let t=new FormData;t.append("title",this.formData.title),t.append("price",this.formData.price.toString()),t.append("description",this.formData.description),t.append("category",this.formData.category),this.formData.image&&t.append("image",this.formData.image),m.default.fire({title:"Are you sure you want to update this product?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No",cancelButtonText:"Cancelar"}).then(e=>s(this,null,function*(){if(e.isConfirmed)try{let a=yield f(this.productsService.updateProduct(this.productState._id,t));m.default.fire("Updated product","","success"),setTimeout(()=>{window.location.reload()},3e3),console.log("Updated product:",a)}catch(a){console.error("Error updating the product:",a)}else e.isDenied&&m.default.fire("Product not updated","","info")}))})}static \u0275fac=function(t){return new(t||l)(w(P))};static \u0275cmp=x({type:l,selectors:[["app-update-product"]],standalone:!0,features:[q([F]),S],decls:42,vars:7,consts:[["aria-hidden","true","tabindex","-1",1,"fixed","bg-slate-900","bg-opacity-85","h-screen","inset-0","z-50","flex","justify-center","items-center","w-full"],[1,"relative","p-4","w-full","max-w-2xl"],[1,"relative","p-4","bg-white","rounded-lg","shadow","dark:bg-gray-800","sm:p-5"],[1,"flex","justify-between","items-center","pb-4","mb-4","rounded-t","border-b","sm:mb-5","dark:border-gray-600"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"fas","fa-times",3,"click"],["action","#",3,"submit"],[1,"grid","gap-4","mb-4","sm:grid-cols-2"],["for","name",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","name","name","id","name","placeholder","Type product name","required","",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-primary-600","focus:border-primary-600","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input","value"],["for","price",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","number","name","price","id","price","pattern","[0-9]*","placeholder","$2999","required","",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-primary-600","focus:border-primary-600","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input","value"],["for","category",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["id","category",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-primary-500","focus:border-primary-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input"],["selected","",3,"value"],["value","TV/Monitors"],["value","PC/Laptop"],["value","Gaming/Console"],["value","Phones"],["for","file_input",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["id","file_input","name","image","type","file",1,"block","w-full","text-sm","p-2","text-gray-900","border","border-gray-300","rounded-lg","cursor-pointer","bg-gray-50","dark:text-gray-400","focus:outline-none","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400",3,"change"],[1,"rounded-md","mt-2","mx-auto","h-40","object-contain",3,"src","alt"],[1,"sm:col-span-2"],["for","description",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["id","description","rows","4","placeholder","Write product description here",1,"block","p-2.5","w-full","text-sm","text-gray-900","bg-gray-50","rounded-lg","border","border-gray-300","focus:ring-primary-500","focus:border-primary-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-primary-500","dark:focus:border-primary-500",3,"input","value"],["type","submit",1,"text-white","bg-orange-500","inline-flex","items-center","hover:bg-orange-500","focus:ring-4","focus:outline-none","focus:ring-orange-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","dark:bg-orange-600","dark:hover:bg-orange-700","dark:focus:ring-orange-800",3,"click"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),n(5," Update Product "),i(),o(6,"button",5),u("click",function(){return e.closeUpdateModal()}),i()(),o(7,"form",6),u("submit",function(d){return e.submitUpdateForm(d)}),o(8,"div",7)(9,"div")(10,"label",8),n(11,"Title"),i(),o(12,"input",9),u("input",function(d){return e.handleOnChange("title",d)}),i()(),o(13,"div")(14,"label",10),n(15,"Price"),i(),o(16,"input",11),u("input",function(d){return e.handleOnChange("price",d)}),i()(),o(17,"div")(18,"label",12),n(19,"Category"),i(),o(20,"select",13),u("input",function(d){return e.handleOnChange("category",d)}),o(21,"option",14),n(22),i(),o(23,"option",15),n(24,"TV/Monitors"),i(),o(25,"option",16),n(26,"PC"),i(),o(27,"option",17),n(28,"Gaming/Console"),i(),o(29,"option",18),n(30,"Phones"),i()()(),o(31,"div")(32,"label",19),n(33,"Image"),i(),o(34,"input",20),u("change",function(d){return e.handleFileChange(d)}),i(),p(35,"img",21),i(),o(36,"div",22)(37,"label",23),n(38,"Description"),i(),o(39,"textarea",24),u("input",function(d){return e.handleOnChange("description",d)}),i()()(),o(40,"button",25),u("click",function(){return e.deleteProduct()}),n(41," Update product "),i()()()()()),t&2&&(c(12),h("value",e.productState.product().title),c(4),h("value",e.productState.product().price),c(5),h("value",e.productState.product().category),c(),A(e.productState.product().category),c(13),h("src",e.productState.product().image,k),h("alt",e.productState.product().title),c(4),g("value",e.productState.product().description))}})};var E=V(W());var Y=l=>["/product/",l];function Q(l,r){if(l&1){let t=I();o(0,"div",6)(1,"button",8),u("click",function(a){v(t);let d=C();return _(d.edit(a))}),p(2,"i",9),n(3," Edit "),i(),o(4,"button",10),u("click",function(a){v(t);let d=C();return _(d.delete(a))}),p(5,"i",11),n(6," Delete "),i()()}}function X(l,r){if(l&1){let t=I();o(0,"button",12),u("click",function(a){v(t);let d=C();return _(d.add(a))}),L(),o(1,"svg",13),p(2,"path",14),i(),n(3," Add to cart "),i()}}function ee(l,r){l&1&&p(0,"app-update-product")}var T=class l{constructor(r){this.productsService=r}product=N.required();isAuthenticated=b(Z);showUpdateModal=!1;addToCart=j();_id="";add(r){return s(this,null,function*(){let t=localStorage.getItem("authToken");t&&(r.stopPropagation(),r.preventDefault(),this.addToCart.emit(this.product()),yield f(this.productsService.addToCart(this.product()._id,t)))})}edit(r){document.body.classList.add("overflow-hidden"),r.stopPropagation(),r.preventDefault(),this.showUpdateModal=!0,this._id=this.product()._id}delete(r){r.preventDefault(),E.default.fire({title:"\xBFSeguro que quieres eliminar este producto?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No",cancelButtonText:"Cancelar"}).then(t=>s(this,null,function*(){t.isConfirmed?(E.default.fire("Producto eliminado","","success"),yield f(this.productsService.deleteProduct(this.product()._id)),window.location.reload()):t.isDenied&&E.default.fire("Producto no eliminado","","info")}))}static \u0275fac=function(t){return new(t||l)(w(P))};static \u0275cmp=x({type:l,selectors:[["app-product-card"]],inputs:{product:[1,"product"]},outputs:{addToCart:"addToCart"},standalone:!0,features:[S],decls:14,vars:13,consts:[[1,"mx-auto","pb-4","bg-slate-800","border","rounded-t-2xl","rounded-b-2xl","border-slate-600","rounded-md","shadow-md","hover:shadow-lg"],[3,"routerLink"],["alt","Product Image",1,"cursor-pointer","rounded-t-2xl","w-full","h-72","object-cover",3,"src"],[1,"text-xl","text-center","p-2","font-semibold","bg-slate-700","w-full","text-white","dark:text-white","mb-2","line-clamp-1"],[1,"flex","flex-col","justify-between","items-center","gap-3"],[1,"block","text-lg","font-semibold","text-white","dark:text-white"],[1,"flex","flex-wrap","gap-4"],[1,"inline-flex","items-center","gap-2","bg-blue-800","p-3","text-white","font-medium","rounded-full","text-md"],[1,"inline-flex","items-center","gap-2","text-white","bg-orange-500","hover:bg-orange-600","focus:ring-4","focus:ring-orange-300","font-medium","rounded-md","text-sm","px-4","py-2","dark:bg-orange-600","dark:hover:bg-orange-700","focus:outline-none","dark:focus:ring-orange-800",3,"click"],[1,"fas","fa-pen"],[1,"inline-flex","items-center","gap-2","text-white","bg-red-500","hover:bg-red-600","focus:ring-4","focus:ring-red-300","font-medium","rounded-md","text-sm","px-4","py-2","dark:bg-red-600","dark:hover:bg-red-700","focus:outline-none","dark:focus:ring-red-800",3,"click"],[1,"fas","fa-trash-alt"],[1,"inline-flex","items-center","gap-2","bg-blue-800","p-3","text-white","font-medium","rounded-full","text-md",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 4h1.5L9 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm-8.5-3h9.25L19 7H7.312"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"picture",1),p(2,"img",2),i(),o(3,"div")(4,"a",1)(5,"h5",3),n(6),i()(),o(7,"div",4)(8,"span",5),n(9),O(10,"currency"),i(),D(11,Q,7,0,"div",6)(12,X,4,0,"button",7),i()(),D(13,ee,1,0,"app-update-product"),i()),t&2&&(c(),g("routerLink",M(9,Y,e.product()._id)),c(),g("src",e.product().image,k),c(2),g("routerLink",M(11,Y,e.product()._id)),c(2),B(" ",e.product().title," "),c(3),B(" ",H(10,7,e.product().price)," "),c(2),U(e.isAuthenticated.getUserRole()?11:12),c(2),U(e.showUpdateModal?13:-1))},dependencies:[R,G,y]})};export{T as a};
